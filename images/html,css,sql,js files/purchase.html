<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FootWearX - Purchase</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            text-align: center;
            background-color: rgb(10,46,88);
            color: #333;
        }
        .container {
            max-width: 400px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            background-color: #ffffff;
        }
        .hidden { display: none; }
        button {
            padding: 10px 15px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover { background-color: #218838; }
        input, select, textarea {
            width: 90%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f1f1f1;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #28a745;
            background-color: #ffffff;
        }
        textarea { height: 100px; }
        h2, h3 { color: #28a745; }
        .error { color: red; font-size: 0.9em; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Choose Payment Method</h2>
        <select id="paymentMethod" onchange="toggleForms()">
            <option value="">Select Payment Method</option>
            <option value="cod">Cash on Delivery</option>
            <option value="card">Card Payment</option>
            <option value="siteVisit">Site Visit</option>
        </select>
        
        <div id="codDetails" class="hidden">
            <h3>Enter Delivery Details</h3>
            <input type="text" id="codName" placeholder="Your Name" required>
            <input type="text" id="codAddress" placeholder="Delivery Address" required>
            <textarea id="codDescription" placeholder="Order Description" required></textarea>
        </div>
        
        <div id="cardDetails" class="hidden">
            <h3>Enter Card Details</h3>
            <input type="text" id="cardNumber" placeholder="Card Number" required>
            <span class="error" id="cardError">Enter a valid 16-digit card number.</span>
            <input type="text" id="cardHolder" placeholder="Card Holder Name" required>
            <input type="text" id="expiryDate" placeholder="Expiry Date (MM/YY)" required>
            <span class="error" id="expiryError">Enter a valid expiry date (MM/YY).</span>
            <input type="password" id="cvv" placeholder="CVV" required>
            <span class="error" id="cvvError">Enter a valid 3 or 4-digit CVV.</span>
        </div>

        <div id="siteVisitDetails" class="hidden">
            <h3>Enter NIC Details</h3>
            <input type="text" id="nicNumber" placeholder="NIC Number" required>
            <span class="error" id="nicError">Enter a valid NIC (9 digits + V or 12 digits).</span>
            <input type="text" id="nicName" placeholder="NIC Name" required>
        </div>
        
        <button onclick="confirmPurchase()">Confirm Purchase</button>
    </div>
    
    <script>
        function toggleForms() {
            document.getElementById("codDetails").classList.add("hidden");
            document.getElementById("cardDetails").classList.add("hidden");
            document.getElementById("siteVisitDetails").classList.add("hidden");

            var paymentMethod = document.getElementById("paymentMethod").value;
            if (paymentMethod) document.getElementById(paymentMethod + "Details").classList.remove("hidden");
        }

        function validateCard() {
            var cardNumber = document.getElementById("cardNumber").value;
            document.getElementById("cardError").style.display = /^[0-9]{16}$/.test(cardNumber) ? "none" : "block";
            
            var expiryDate = document.getElementById("expiryDate").value;
            document.getElementById("expiryError").style.display = /^(0[1-9]|1[0-2])\/[0-9]{2}$/.test(expiryDate) ? "none" : "block";
            
            var cvv = document.getElementById("cvv").value;
            document.getElementById("cvvError").style.display = /^[0-9]{3,4}$/.test(cvv) ? "none" : "block";
            
            return document.getElementById("cardError").style.display === "none" &&
                   document.getElementById("expiryError").style.display === "none" &&
                   document.getElementById("cvvError").style.display === "none";
        }

        function validateNIC() {
            var nic = document.getElementById("nicNumber").value;
            document.getElementById("nicError").style.display = /^(\d{9}V|\d{12})$/.test(nic) ? "none" : "block";
            return document.getElementById("nicError").style.display === "none";
        }

        function confirmPurchase() {
            var paymentMethod = document.getElementById("paymentMethod").value;
            if (!paymentMethod) { alert("Please select a payment method."); return; }

            if (paymentMethod === "cod") {
                if (!document.getElementById("codName").value || !document.getElementById("codAddress").value || !document.getElementById("codDescription").value) {
                    alert("Please fill in all the delivery details."); return;
                }
            }

            if (paymentMethod === "card" && !validateCard()) return;
            if (paymentMethod === "siteVisit" && !validateNIC()) return;

            alert("Your purchase has been confirmed!");
            window.location.href = "./user-portal.html";
        }
    </script>
</body>
</html>
